<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>join1</title>
<script
	src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"
	integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3"
	crossorigin="anonymous"></script>
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css"
	rel="stylesheet"
	integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi"
	crossorigin="anonymous">
<script src="https://code.jquery.com/jquery-3.7.1.js"
	integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4="
	crossorigin="anonymous"></script>
<style>
body {
	background-color: #f9fbff;
	margin: 0;
	padding: 0;
	font-family: Arial, sans-serif;
}

.topbar {
	display: flex;
	align-items: center;
	justify-content: center;
	padding-top: 30px;
	padding-left: 0px;
	padding-bottom: 20px;
	margin-bottom: 50px;
	margin-top: 10px;
	height: 50px;
	width: 100%;
}

.menu-icon {
	position: 40px 60px;
	height: 40%;
	margin-right: 250px;
}

.join {
	font-size: 30px;
	font-weight: bold;
}

.main-contents-contain {
	background-color: white;
	width: 800px;
	height: 830px;
	box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.5);
	border-radius: 30px;
	margin: 0 auto;
	margin-top: 100px;
}

.steps {
	display: flex;
	justify-content: space-between;
	width: 100%;
}

.step {
	flex: 1;
	text-align: center;
	padding: 20px;
	width: 100%;
	font-weight: bold;
}

.step1 {
	border-radius: 30px 0 0 0;
	background-color: #DDE9FF;
	width: 33%;
}

.step2 {
	background-color: #B0CBEA;
	color: white;
	width: 33%;
}

.step3 {
	border-radius: 0 30px 0 0;
	background-color: #859EC6;
	color: white;
	width: 33%;
}

.content {
	text-align: center;
}

.next-button {
	margin: 0 auto;
	font-size: 20px;
	color: white;
	background-color: #5577ff;
	border: none;
	border-radius: 10px;
	cursor: pointer;
	width: 200px;
	margin-top: 10px;
	margin-bottom: 10px;
}

.join-button:hover {
	background-color: #4b5c6a;
}

.input {
	margin: 10px;
	padding: 12px;
	font-size: 16px;
	background-color: #f0f0f0;
	border: 2px solid #ccc;
	border-radius: 8px;
	box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
	width: 400px;
	outline: none;
	text-align: left;
}

.agreeAll {
	margin-right: 230px;
}

.terms-list {
	margin-top: 20px;
	border: 2px solid #ccc;
	text-align: left;
	padding: 20px;
	margin-top: 20px;
	border-radius: 5px;
	width: 360px;
	margin-left: 220px;
}

.terms-list label {
	margin-left: 0px;
}

.form-label {
	margin-left: 200px;
	text-align: left;
	display: block;
}
</style>
</head>
<body>
	<div class="topbar">
		<div class="menu-icon">
			<div>
				<img src="/photo/menuBar/logo2.png" height="100px" width="100%"
					style="cursor: pointer;" id="clickImg" />
			</div>
		</div>
		<div class="join">
			<p style="margin-bottom: 0; margin-right: 450px; margin-top: 80px;">회원가입</p>
		</div>
	</div>
	<div class="main-contents-contain">
		<div class="steps">
			<div class="step step1">Step01</div>
			<div class="step step2">Step02</div>
			<div class="step step3">Step03</div>
		</div>

		<div class="content">
			<form class="needs-validation" action="/member/join2" method="POST">
				<br />
				<div class="divs">
					<div class="div">
						<label for="id" class="form-label">아이디</label> <input type="text" class="input" id="userId" name="userId" placeholder="아이디를 입력하세요" style="margin-bottom: 40px" required> 
						<span id="idCheckResult" style="display: block; margin-top: -30px; margin-bottom: -21px; font-size: 0.9em;"></span>
					</div>
					<div class="div">
						<label for="pwd" class="form-label" style="margin-top: 40px">비밀번호</label>
						<input type="password" class="input" id="userPw" name="userPw" placeholder="8~15자 사이의 영문숫자특수문자로 조합해주세요" style="margin-bottom: 40px" required> 
						<span id="pwdCheckResult" style="display: block; margin-top: -30px; margin-bottom: -21px; font-size: 0.9em;"></span>
					</div>
					<div class="div">
						<label for="pwdConfirm" class="form-label" style="margin-top: 40px">비밀번호 확인</label> 
						<input type="password" class="input" id="pwdConfirm" name="pwdConfirm" placeholder="비밀번호를 다시 입력해주세요" style="margin-bottom: 40px" required> 
						<span id="pwdConfirmCheckResult" style="display: block; margin-top: -30px; margin-bottom: -21px; font-size: 0.9em;"></span>
					</div>

					<br /> <br />
					<div class="checks">
						<div class="agreeAll">
							<label> <input type="checkbox" id="agreeAll"> 전체
								동의
							</label>
						</div>
						<div class="terms-list">
							<label> <input type="checkbox" class="term"> 이용약관
								동의 (필수)
							</label><br> <label> <input type="checkbox" class="term">
								개인정보 수집 및 이용에 대한 동의 (필수)
							</label><br>
						</div>
					</div>
				</div>
				<br /> <br />
				<div class="next-button">
					<button class="next-button" id="nextButton">다음 페이지</button>
				</div>
			</form>
		</div>

	</div>

	<script>
	    const agreeAllCheckbox = document.getElementById('agreeAll');
	    const termCheckboxes = document.querySelectorAll('.term');
	    const nextButton = document.getElementById('nextbutton');
	    
	    agreeAllCheckbox.addEventListener('change', function () {
	        const isChecked = this.checked;
	        termCheckboxes.forEach(term => {
	            term.checked = isChecked;
	        });
	    });
	    
	    termCheckboxes.forEach(term => {
	        term.addEventListener('change', function () {
	            const allChecked = Array.from(termCheckboxes).every(term => term.checked);
	            agreeAllCheckbox.checked = allChecked;
	        });
	    });
	    
// 	    nextButton.addEventListener('click', function () {
// 	        const allChecked = Array.from(termCheckboxes).every(term => term.checked);
// 	        if (!allChecked) {
// 	            alert('약관 동의는 필수입니다');
// 	        } else {
// 	        	window.location.href = 'join2';
// 	        }
// 	    });

		document.addEventListener('DOMContentLoaded', function () {
    		const nextButton = document.getElementById('nextButton'); // nextButton 요소 가져오기
    		const termCheckboxes = document.querySelectorAll('.term'); // 약관 체크박스 가져오기

    	nextButton.addEventListener('click', function () {
        	const allChecked = Array.from(termCheckboxes).every(term => term.checked);
        	if (!allChecked) {
            	alert('약관 동의는 필수입니다');
            	button.removeEventListener("click", handleClick);
        	} else {
            	window.location.href = 'join2'; // 다음 페이지로 이동
        		}
    		});
		});
		
		document.addEventListener('DOMContentLoaded', function() {
			const passwordInput = document.getElementById('userPw');
		    const passwordMessage = document.getElementById('pwdCheckResult');
		    const passwordPattern = /^(?=.*[A-Za-z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,15}$/;

		    passwordInput.addEventListener('blur', function () {
		        const password = passwordInput.value;

		        if (passwordPattern.test(password)) {
		            passwordMessage.textContent = '사용 가능한 비밀번호입니다.';
		            passwordMessage.style.color = 'green';
		        } else {
		            passwordMessage.textContent = '비밀번호는 8~15자이며, 영문, 숫자, 특수문자를 포함해야 합니다.';
		            passwordMessage.style.color = 'red';
		        }
		    });
		})
		
		document.addEventListener('DOMContentLoaded', function () {
		    const passwordInput = document.getElementById('userPw');
		    const confirmPasswordInput = document.getElementById('pwdConfirm');
		    const passwordMessage = document.getElementById('pwdConfirmCheckResult');
		
		    // 비밀번호 확인 입력란에서 이벤트 리스너 추가
		    confirmPasswordInput.addEventListener('blur', function () {
		        // 비밀번호와 비밀번호 확인 값 비교
		        if (passwordInput.value !== confirmPasswordInput.value) {
		            passwordMessage.textContent = '비밀번호를 다시 입력해주세요.';
		            passwordMessage.style.color = 'red';
		        } else {
		            passwordMessage.textContent = '';
		        }
		    });
		});
		
		window.onload = () =>{
    		document.getElementById('userId').addEventListener('change', function() {
    			const idResult = document.getElementById('idCheckResult');
    			if(this.value.trim() == ''){
//     				idResult.innerText = '아이디를 확인해주세요';
//     				idResult.style.color = 'black';
    			} else {
    				$.ajax({
    					url:'/member/checkId',
    					data: {userId:this.value.trim()},
    					success: data => {
    				        if (data == '0') {
    				            idResult.innerText = '사용가능한 아이디 입니다.';
    				            idResult.style.color = 'green';
    				        } else {
    				            idResult.innerText = '이미 사용 중인 아이디입니다.';
    				            idResult.style.color = 'red';
    				        }
    				    },
    				    error: data => console.log(data)
    				});
    			}
    		}); 
       }
       
		document.addEventListener('DOMContentLoaded', function () {
		    const nextButton = document.getElementById('nextButton');
		    const terms = document.querySelectorAll('.term');

		    // 기존 이벤트 리스너 제거
		    nextButton.replaceWith(nextButton.cloneNode(true));
		    const newNextButton = document.getElementById('nextButton'); // 새 버튼 가져오기

		    newNextButton.addEventListener('click', function (event) {
		        const allChecked = Array.from(terms).every(term => term.checked);
		        if (!allChecked) {
		            alert('약관 동의는 필수입니다');
		            event.preventDefault(); // 기본 이벤트(폼 제출 등) 방지
		        }
		    }, { once: true }); // 이벤트 리스너를 한 번만 실행
		});

       
       document.addEventListener('click', function () {
    	    const nextButton = document.getElementById('nextButton');
    	    const userIdInput = document.getElementById('userId');
    	    const userPwInput = document.getElementById('userPw');
    	    const pwdConfirmInput = document.getElementById('pwdConfirm');

    	    nextButton.addEventListener('click', function (event) {
    	        const userId = userIdInput.value.trim();
    	        const userPw = userPwInput.value.trim();
    	        const pwdConfirm = pwdConfirmInput.value.trim();

    	        if (!userId || !userPw || !pwdConfirm) {
    	            alert('빈칸을 모두 입력해주세요');
    	            event.preventDefault();
    	            return;
    	        }
    	        if (userPw !== pwdConfirm) {
    	            alert('비밀번호와 비밀번호 확인이 일치하지 않습니다');
    	            event.preventDefault();
    	            return;
    	        }
    	    });
    	});
       
       document.getElementById('clickImg').addEventListener('click', function () {
           window.location.href = '/';
       });

    </script>
</body>
</html>